{
  "model_version": "2.0.0",
  "temporal_split": {
    "train": "2014-2021",
    "val": "2022-2023",
    "test": "2024-2025"
  },
  "data_summary": {
    "train_rows": 3267,
    "val_rows": 880,
    "test_rows": 958,
    "num_features": 31,
    "numeric_features": [
      "qualifying_position",
      "grid_position",
      "driver_prior_points",
      "driver_prior_wins",
      "driver_prior_position",
      "constructor_prior_points",
      "constructor_prior_wins",
      "constructor_prior_position",
      "historical_avg_stops_at_circuit",
      "driver_historical_avg_stops",
      "circuit_lat",
      "circuit_lng",
      "circuit_avg_positions_gained",
      "driver_recent_avg_finish",
      "driver_circuit_avg_finish",
      "driver_avg_positions_gained",
      "constructor_recent_avg_finish",
      "driver_form_trend",
      "gap_to_teammate_quali",
      "season_round_number",
      "constructor_relative_performance",
      "driver_dnf_rate",
      "constructor_dnf_rate",
      "track_temp",
      "air_temp",
      "humidity",
      "is_wet_race",
      "wind_speed"
    ],
    "categorical_features": [
      "driver_id",
      "constructor_id",
      "circuit_id"
    ]
  },
  "walk_forward_cv_baseline": {
    "folds": [
      {
        "val_year": 2018,
        "train_size": 1647,
        "val_size": 420,
        "train_mae": 1.994837524363442,
        "val_mae": 3.74859689413412,
        "val_spearman": 0.5790456271060177,
        "gap": 1.7537593697706781
      },
      {
        "val_year": 2019,
        "train_size": 2067,
        "val_size": 420,
        "train_mae": 2.139675163902803,
        "val_mae": 3.77754699786766,
        "val_spearman": 0.5662404587322476,
        "gap": 1.6378718339648572
      },
      {
        "val_year": 2020,
        "train_size": 2487,
        "val_size": 340,
        "train_mae": 2.249348253470119,
        "val_mae": 4.325078464727827,
        "val_spearman": 0.3598859496618628,
        "gap": 2.0757302112577083
      },
      {
        "val_year": 2021,
        "train_size": 2827,
        "val_size": 440,
        "train_mae": 2.4014259801838587,
        "val_mae": 3.534495691420998,
        "val_spearman": 0.6327114046371364,
        "gap": 1.1330697112371393
      },
      {
        "val_year": 2022,
        "train_size": 3267,
        "val_size": 440,
        "train_mae": 2.4312591773373757,
        "val_mae": 3.8803125914197305,
        "val_spearman": 0.510019404048866,
        "gap": 1.4490534140823548
      },
      {
        "val_year": 2023,
        "train_size": 3707,
        "val_size": 440,
        "train_mae": 2.4861017244599988,
        "val_mae": 3.597481107135829,
        "val_spearman": 0.6002161308527624,
        "gap": 1.11137938267583
      }
    ],
    "mean_val_mae": 3.8105852911176936,
    "mean_val_spearman": 0.5413531625064821,
    "mean_gap": 1.526810653831428
  },
  "best_hyperparameters": {
    "ridge": {
      "alpha": 5.073232044639776
    },
    "random_forest": {
      "n_estimators": 300.0,
      "max_depth": 9.0,
      "min_samples_leaf": 30.0,
      "max_features": 0.49796360750555574
    },
    "gradient_boosting": {
      "n_estimators": 200.0,
      "max_depth": 4.0,
      "learning_rate": 0.02948880426255718,
      "subsample": 0.6121546090165189,
      "min_samples_leaf": 42.0
    },
    "xgboost": {
      "n_estimators": 350.0,
      "max_depth": 3.0,
      "learning_rate": 0.013916512220129733,
      "subsample": 0.628105631278143,
      "colsample_bytree": 0.791860661141376,
      "reg_alpha": 0.15387241287156497,
      "reg_lambda": 0.02427008188528394,
      "min_child_weight": 4.0
    }
  },
  "regression": {
    "ridge": {
      "train_mae": 3.4590425315942888,
      "train_rmse": 4.468136301011229,
      "val_mae": 3.349452657425817,
      "val_rmse": 4.392046251653715,
      "val_spearman": 0.6374912138521164,
      "test_mae": 3.153622097541287,
      "test_rmse": 4.056335293725767,
      "test_spearman": 0.7051184753511818,
      "position_bucket_accuracy": {
        "bucket_accuracy": 0.6524008350730689,
        "confusion": {
          "P1-3": 0.09722222222222222,
          "P4-10": 0.6101190476190477,
          "P11-20": 0.8493723849372385
        }
      },
      "train_val_gap": -0.10958987416847155
    },
    "random_forest": {
      "train_mae": 3.2042453382684717,
      "train_rmse": 4.1491850849242065,
      "val_mae": 3.417468967515358,
      "val_rmse": 4.414959985947865,
      "val_spearman": 0.6353330378456028,
      "test_mae": 3.1441753951266804,
      "test_rmse": 4.0316678425171215,
      "test_spearman": 0.7096859417919829,
      "position_bucket_accuracy": {
        "bucket_accuracy": 0.6701461377870563,
        "confusion": {
          "P1-3": 0.13194444444444445,
          "P4-10": 0.6398809523809523,
          "P11-20": 0.8535564853556485
        }
      },
      "feature_importance": {
        "qualifying_position": 0.38693938848478354,
        "grid_position": 0.218918339523268,
        "constructor_recent_avg_finish": 0.10868378634815973,
        "driver_recent_avg_finish": 0.07291652154589522,
        "constructor_prior_points": 0.03665424728015624,
        "constructor_relative_performance": 0.034112927891484776,
        "constructor_prior_wins": 0.014516164250162587,
        "driver_prior_points": 0.012268738266452407,
        "circuit_id": 0.00935362922046129,
        "driver_circuit_avg_finish": 0.009135661481543687,
        "gap_to_teammate_quali": 0.008971486528215705,
        "constructor_dnf_rate": 0.008796232724918144,
        "driver_avg_positions_gained": 0.008457781588380177,
        "driver_id": 0.0072435947796033445,
        "driver_dnf_rate": 0.007073162680430239
      },
      "train_val_gap": 0.21322362924688631
    },
    "gradient_boosting": {
      "train_mae": 3.1111701405109193,
      "train_rmse": 4.037067195705291,
      "val_mae": 3.4230845502803606,
      "val_rmse": 4.410537565431399,
      "val_spearman": 0.6371118651579448,
      "test_mae": 3.1958385434465684,
      "test_rmse": 4.075679910702641,
      "test_spearman": 0.7010616103090963,
      "position_bucket_accuracy": {
        "bucket_accuracy": 0.6544885177453027,
        "confusion": {
          "P1-3": 0.09027777777777778,
          "P4-10": 0.6190476190476191,
          "P11-20": 0.8493723849372385
        }
      },
      "feature_importance": {
        "qualifying_position": 0.45114201785185415,
        "grid_position": 0.14619615709561845,
        "constructor_recent_avg_finish": 0.07655717105420656,
        "driver_recent_avg_finish": 0.0563863521785778,
        "driver_avg_positions_gained": 0.023856072614126998,
        "gap_to_teammate_quali": 0.021734354702569042,
        "driver_form_trend": 0.017223170769946516,
        "driver_prior_points": 0.01708011588872296,
        "circuit_id": 0.015654834335761498,
        "constructor_prior_points": 0.015290353919429019,
        "driver_circuit_avg_finish": 0.014650518534671515,
        "constructor_dnf_rate": 0.014615459185801495,
        "driver_dnf_rate": 0.013959981580009904,
        "driver_id": 0.0136216391260008,
        "constructor_relative_performance": 0.013377689993699243
      },
      "train_val_gap": 0.3119144097694413
    },
    "xgboost": {
      "train_mae": 3.2374227046966553,
      "train_rmse": 4.184706709963446,
      "val_mae": 3.4096834659576416,
      "val_rmse": 4.411326196606437,
      "val_spearman": 0.6368209535826599,
      "test_mae": 3.099839448928833,
      "test_rmse": 4.012255966038523,
      "test_spearman": 0.7105511927865518,
      "position_bucket_accuracy": {
        "bucket_accuracy": 0.673277661795407,
        "confusion": {
          "P1-3": 0.1388888888888889,
          "P4-10": 0.6488095238095238,
          "P11-20": 0.8514644351464435
        }
      },
      "feature_importance": {
        "qualifying_position": 0.2356385588645935,
        "grid_position": 0.1246696189045906,
        "constructor_relative_performance": 0.1050754263997078,
        "constructor_prior_wins": 0.064426489174366,
        "constructor_recent_avg_finish": 0.060573019087314606,
        "driver_recent_avg_finish": 0.0522264800965786,
        "constructor_prior_points": 0.04273486137390137,
        "driver_prior_wins": 0.027545038610696793,
        "constructor_prior_position": 0.025661034509539604,
        "driver_prior_points": 0.02105865627527237,
        "gap_to_teammate_quali": 0.01885240525007248,
        "driver_avg_positions_gained": 0.01728184148669243,
        "driver_prior_position": 0.01671389490365982,
        "driver_id": 0.016339046880602837,
        "historical_avg_stops_at_circuit": 0.01615877076983452
      },
      "train_val_gap": 0.17226076126098633
    },
    "ensemble": {
      "test_mae": 3.085309486557575,
      "test_rmse": 4.03646921040382,
      "test_spearman": 0.7056281201580465,
      "position_bucket_accuracy": {
        "bucket_accuracy": 0.6659707724425887,
        "confusion": {
          "P1-3": 0.18055555555555555,
          "P4-10": 0.6130952380952381,
          "P11-20": 0.8493723849372385
        }
      },
      "meta_weights": [
        0.30276970150529275,
        0.2824109660784568,
        0.0061759629481960825,
        0.43839231276901547
      ],
      "base_models": [
        "ridge",
        "random_forest",
        "gradient_boosting",
        "xgboost"
      ],
      "train_mae": 3.2379965440641243,
      "train_val_gap": -0.1526870575065491
    }
  },
  "baseline_grid_position": {
    "test_mae": 3.125260960334029,
    "test_spearman": 0.6900433343918728
  },
  "classification": {
    "is_podium": {
      "logistic": {
        "train_accuracy": 0.8607284970921335,
        "train_f1": 0.6566037735849056,
        "test_accuracy": 0.8455114822546973,
        "test_f1": 0.642512077294686,
        "test_roc_auc": 0.9292246792246793,
        "confusion_matrix_test": [
          [
            677,
            137
          ],
          [
            11,
            133
          ]
        ]
      },
      "random_forest": {
        "train_accuracy": 0.9069482705846342,
        "train_f1": 0.7466666666666667,
        "test_accuracy": 0.8684759916492694,
        "test_f1": 0.6701570680628273,
        "test_roc_auc": 0.9425419737919738,
        "confusion_matrix_test": [
          [
            704,
            110
          ],
          [
            16,
            128
          ]
        ]
      },
      "gradient_boosting": {
        "train_accuracy": 0.9868380777471687,
        "train_f1": 0.9537136706135629,
        "test_accuracy": 0.8966597077244259,
        "test_f1": 0.6550522648083623,
        "test_roc_auc": 0.9280644280644281,
        "confusion_matrix_test": [
          [
            765,
            49
          ],
          [
            50,
            94
          ]
        ]
      },
      "xgboost": {
        "train_accuracy": 1.0,
        "train_f1": 1.0,
        "test_accuracy": 0.8872651356993737,
        "test_f1": 0.6375838926174496,
        "test_roc_auc": 0.928951678951679,
        "confusion_matrix_test": [
          [
            755,
            59
          ],
          [
            49,
            95
          ]
        ]
      }
    },
    "is_top_10": {
      "logistic": {
        "train_accuracy": 0.7679828588919498,
        "test_accuracy": 0.8016701461377871,
        "test_f1": 0.7948164146868251,
        "test_roc_auc": 0.8777065899581591
      },
      "random_forest": {
        "train_accuracy": 0.8206305479032752,
        "test_accuracy": 0.8016701461377871,
        "test_f1": 0.806910569105691,
        "test_roc_auc": 0.8750000000000002
      },
      "gradient_boosting": {
        "train_accuracy": 0.9115396388123661,
        "test_accuracy": 0.7651356993736952,
        "test_f1": 0.7692307692307693,
        "test_roc_auc": 0.8373256624825662
      },
      "xgboost": {
        "train_accuracy": 1.0,
        "test_accuracy": 0.7588726513569938,
        "test_f1": 0.769690927218345,
        "test_roc_auc": 0.8220319037656904
      }
    }
  },
  "best_model": {
    "regression": "ensemble",
    "regression_mae": 3.085309486557575,
    "regression_spearman": 0.7056281201580465,
    "train_val_gap": -0.1526870575065491,
    "regression_justification": "Selected ensemble for deployment: lowest test MAE (3.0853). Spearman: 0.7056. Train/Val gap: -0.1527.",
    "classification_podium": "xgboost"
  },
  "success_criteria": {
    "test_mae_under_3_2": {
      "target": "< 3.2",
      "actual": "3.0853",
      "passed": true
    },
    "spearman_over_0_65": {
      "target": "> 0.65",
      "actual": "0.7056",
      "passed": true
    },
    "no_overfitting": {
      "target": "train_val_gap < 0.5",
      "actual": "-0.1527",
      "passed": true
    },
    "beats_baseline": {
      "target": "MAE < baseline (3.1253)",
      "actual": "3.0853",
      "passed": true
    },
    "all_passed": true
  }
}